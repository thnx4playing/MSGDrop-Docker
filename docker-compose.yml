version: '3.8'

services:
  msgdrop:
    build: .
    container_name: msgdrop
    ports:
      - "443:443"
    environment:
      - PORT=443
      - DATA_DIR=/data
      - SESSION_TTL_SECONDS=900
      - UNLOCK_CODE_HASH=5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8
      - DOMAIN=msg.wikistories.org
      - COOKIE_DOMAIN=msg.wikistories.org
      - PUBLIC_BASE_URL=https://msg.wikistories.org
      - SSL_CERT_PATH=/etc/letsencrypt/live/msg.wikistories.org/fullchain.pem
      - SSL_KEY_PATH=/etc/letsencrypt/live/msg.wikistories.org/privkey.pem
      - MSGDROP_SECRET_JSON={"edgeAuthToken":"your_random_token_here"}
    volumes:
      - msgdrop-data:/data
      - /etc/letsencrypt:/etc/letsencrypt:ro
    restart: unless-stopped

volumes:
  msgdrop-data:
    driver: local


